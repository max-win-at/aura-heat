<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AURA HEAT | Intelligent Heating Infrastructure</title>
    <meta
      name="description"
      content="AURA HEAT - Transforming server waste heat into sustainable heating solutions"
    />
    <link
      rel="icon"
      type="image/svg+xml"
      href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Crect width='32' height='32' rx='6' fill='%23ea580c'/%3E%3Ctext x='16' y='22' font-family='Inter, system-ui, sans-serif' font-size='14' font-weight='900' font-style='italic' fill='white' text-anchor='middle'%3EAH%3C/text%3E%3C/svg%3E"
    />

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&display=swap"
      rel="stylesheet"
    />

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Styles (custom overrides) -->
    <link rel="stylesheet" href="css/main.css" />

    <!-- Page Components (must load before Alpine.js) -->
    <!-- ESM Modules for Markdown Rendering -->
    <script type="module">
      import { marked } from "https://cdn.jsdelivr.net/npm/marked@15.0.0/lib/marked.esm.js";
      import DOMPurify from "https://cdn.jsdelivr.net/npm/dompurify@3.0.6/dist/purify.es.mjs";

      // Expose to window for app.js to use
      window.marked = marked;
      window.DOMPurify = DOMPurify;
    </script>

    <!-- Alpine.js -->
    <script
      defer
      src="https://cdn.jsdelivr.net/npm/alpinejs@3.14.3/dist/cdn.min.js"
    ></script>

    <!-- htmx -->
    <script src="https://unpkg.com/htmx.org@2.0.4/dist/htmx.min.js"></script>

    <!-- Markdown Support -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dompurify@3.0.6/dist/purify.min.js"></script>

    <!-- App -->
    <script src="js/app.js"></script>
  </head>

  <body x-data="app">
    <!-- Navigation -->
    <nav class="nav">
      <div class="nav-container">
        <!-- Logo -->
        <!-- Logo -->
        <a href="#" class="logo" @click.prevent="goHome()">
          AURA
          <div class="burning-flame">
            <div class="flame-red flame"></div>
            <div class="flame-orange flame"></div>
            <div class="flame-yellow flame"></div>
            <div class="flame-white flame"></div>
            <div class="flame-blue flame-circle"></div>
            <div class="flame-black flame-circle"></div>
          </div>
          <span class="logo-accent">HEAT</span>
        </a>

        <!-- Desktop Navigation -->
        <div class="nav-desktop">
          <template x-for="page in pages" :key="page.id">
            <button
              class="nav-btn"
              :class="{ 'active': currentPage === page.id }"
              @click="loadPage(page.id)"
            >
              <div
                class="nav-btn-icon-wrapper"
                x-html="page.icon || '<svg class=\'nav-btn-icon\' viewBox=\'0 0 24 24\' fill=\'none\' stroke=\'currentColor\' stroke-width=\'2\'><path d=\'M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z\'></path><polyline points=\'14 2 14 8 20 8\'></polyline><line x1=\'16\' y1=\'13\' x2=\'8\' y2=\'13\'></line><line x1=\'16\' y1=\'17\' x2=\'8\' y2=\'17\'></line><polyline points=\'10 9 9 9 8 9\'></polyline></svg>'"
              ></div>
              <span x-text="page.title"></span>
            </button>
          </template>

          <!-- Subpage nav items will be injected here -->
          <div id="subpage-nav"></div>
        </div>

        <!-- Mobile Menu Button -->
        <button
          class="mobile-menu-btn"
          @click="mobileMenuOpen = !mobileMenuOpen"
        >
          <span x-text="mobileMenuOpen ? '✕' : '☰'"></span>
        </button>
      </div>

      <!-- Mobile Menu -->
      <div class="mobile-menu" :class="{ 'open': mobileMenuOpen }">
        <template x-for="page in pages" :key="page.id">
          <button
            class="mobile-nav-item"
            :class="{ 'active': currentPage === page.id }"
            @click="loadPage(page.id); mobileMenuOpen = false"
          >
            <div
              class="nav-btn-icon-wrapper"
              x-html="page.icon || '<svg class=\'nav-btn-icon\' viewBox=\'0 0 24 24\' fill=\'none\' stroke=\'currentColor\' stroke-width=\'2\'><path d=\'M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z\'></path><polyline points=\'14 2 14 8 20 8\'></polyline><line x1=\'16\' y1=\'13\' x2=\'8\' y2=\'13\'></line><line x1=\'16\' y1=\'17\' x2=\'8\' y2=\'17\'></line><polyline points=\'10 9 9 9 8 9\'></polyline></svg>'"
            ></div>
            <span x-text="page.title"></span>
          </button>
        </template>

        <!-- Mobile subpage nav items -->
        <template x-if="subpageNavItems.length > 0">
          <div>
            <div class="mobile-nav-divider"></div>
            <template x-for="item in subpageNavItems" :key="item.label">
              <button
                class="mobile-nav-item"
                @click="handleSubpageNav(item); mobileMenuOpen = false"
                x-html="item.icon + '<span>' + item.label + '</span>'"
              ></button>
            </template>
          </div>
        </template>
      </div>
    </nav>

    <!-- Main Content -->
    <main class="main">
      <div id="main-content">
        <!-- Welcome Screen (shown when no page loaded) -->
        <div class="welcome slide-in" x-show="!currentPage">
          <div class="welcome-badge">Intelligent Heating Infrastructure</div>
          <h1>Willkommen bei AURA<span class="brand-heat">HEAT</span></h1>
          <p>
            Wir wandeln Serverabwärme in nachhaltige Heizlösungen um. Entdecken
            Sie unsere Projekte und erfahren Sie, wie wir die Zukunft
            energieeffizienten Computings gestalten.
          </p>
          <div class="welcome-cta">
            <template x-for="page in pages" :key="page.id">
              <button
                class="welcome-btn welcome-btn-secondary"
                @click="loadPage(page.id)"
              >
                <div
                  class="nav-btn-icon-wrapper"
                  x-html="page.icon || '<svg width=\'20\' height=\'20\' viewBox=\'0 0 24 24\' fill=\'none\' stroke=\'currentColor\' stroke-width=\'2\'><path d=\'M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z\'></path><polyline points=\'14 2 14 8 20 8\'></polyline><line x1=\'16\' y1=\'13\' x2=\'8\' y2=\'13\'></line><line x1=\'16\' y1=\'17\' x2=\'8\' y2=\'17\'></line><polyline points=\'10 9 9 9 8 9\'></polyline></svg>'"
                ></div>
                <span x-text="'View ' + page.title"></span>
              </button>
            </template>
          </div>
        </div>

        <!-- Loaded content will appear here -->
        <div id="page-content" x-show="currentPage"></div>
      </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
      <div class="footer-container">
        <div class="footer-brand">
          <div class="footer-logo">AH</div>
          <span class="footer-brand-text">Aura Heat</span>
        </div>
        <div class="footer-meta">
          <div class="footer-copyright">© Aura Heat Project Group</div>
          <div class="footer-disclaimer">Aided by AI</div>
        </div>
      </div>
    </footer>

    <!-- Lightbox -->
    <div
      class="lightbox-overlay"
      x-show="lightboxOpen"
      x-transition.opacity
      @click="closeLightbox()"
      x-cloak
      @keydown.escape.window="closeLightbox()"
    >
      <div class="lightbox-content">
        <img :src="lightboxImage" class="lightbox-image" @click.stop />
        <button class="lightbox-close" @click="closeLightbox()">&times;</button>
      </div>
    </div>
  </body>
</html>
